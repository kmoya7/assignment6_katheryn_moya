---
title: "Task 3: Lizard Lengths"
author: "Katheryn Moya"
date: "11/27/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Attach packages

library(here)
library(tidyverse)
library(janitor)
library(kableExtra)
library(effsize)
```
# Read in data

```{r}
lizards <- read_csv(here("data","lizards.csv"))
```

# Create simplified data frame

```{r}
female_liz <- lizards %>% 
  select("spp", "sex", "total_length") %>% 
#filter for female and CNUN and CNTE
  filter(sex == "F") %>% 
  filter(spp %in% c("CNUN","CNTE")) 

```

# Data visualization

```{r}
# compare lengths of female lizards for the two species

ggplot(data = female_liz, aes(x = spp, y = total_length)) +
  geom_boxplot(aes(fill = spp)) +
  labs(title = "Female Lizard Lengths in ",
       y = "Count",
       x = "Total length (mm)",
       fill = "Species") +
  scale_fill_manual(values = c("coral3", "darkseagreen3"))+
  scale_color_manual(values = c("coral2", "darkseagreen2")) +
  theme_bw()
```
# Finalized summary table

```{r}
# Create data set with stats

female_liz_stats <- female_liz %>% 
  summarize(mean_total_length = round(mean(total_length, na.rm = TRUE), digits = 2),
            sd_total_length = round(sd(total_length, na.rm = TRUE), digits = 2),
            sample_size = n())

# Create a finalized summary table

female_liz_stats %>%
  kbl(caption = "**Table 1.** ",
      col.names = c("Mean Total Length (mm)",
                    "Standard Deviation (mm)",
                    "Sample Size (n)")) %>%
 kable_classic(full_width = FALSE, html_font = "Cambria") %>% 
   row_spec(0, align = "center", bold = TRUE, color = "#8b5f65", background = "	#ffec8b") %>% 
  row_spec(1, align = "center", bold = FALSE, color = "#8b5f65", background = "#fafad2")
```

Answer: is there a significant difference in total length difference in mean total length between female lizards for the two species? Note: you should do exploratory analyses (e.g. histograms, QQ-plots) to determine if assumptions of a hypothesis test you decide on are appropriate, and include code used to do that, even though it wonâ€™t show up in your knitted document. 

## Exploratory Analyses

```{r}
# make exploratory graphs to explore assumptions of hypothesis test

ggplot(data = female_liz, aes(x = total_length)) +
  geom_histogram(bins = 15) +
  facet_wrap( ~ spp) +
  aes(fill = spp) 

ggplot(data = female_liz, aes(sample = total_length)) +
  geom_qq() +
  facet_wrap( ~ spp) +
  aes(color = spp)
```

```{r}
# create vectors for CNUN and CNTE length for two-sample t-test

cnun_length <- female_liz %>% 
  filter(spp == "CNUN") %>% 
  drop_na(total_length) %>% # removing weights with NA value
  pull(total_length)

cnte_length <- female_liz %>% 
  filter(spp == "CNTE") %>% 
  drop_na(total_length) %>% 
  pull(total_length)

# two-sample t-test

female_liz_t <- t.test(cnun_length, cnte_length)

female_liz_t

# Cohen's d
female_liz_cohen <- cohen.d(cnun_length, cnte_length)

female_liz_cohen
```

```{r}

```


